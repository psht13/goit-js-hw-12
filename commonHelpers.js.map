{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["//================================================================\n// functions\nfunction photoCardTemplate({\n  views,\n  downloads,\n  likes,\n  comments,\n  webformatURL,\n  largeImageURL,\n  tags,\n}) {\n  return `<li class=\"card\">\n      <a class=\"card-image-wrapper\" href=\"${largeImageURL}\">\n        <img class=\"card-image\" src=\"${webformatURL}\" alt=\"${tags}\" data-full=\"${largeImageURL}\">\n      </a>\n      <ul class=\"card-content\">\n        <li class=\"card-content-item\">Likes <span data-likes=\"\">${likes}</span></li>\n        <li class=\"card-content-item\">Comments <span data-comments=\"\">${comments}</span></li>\n        <li class=\"card-content-item\">Views <span data-views=\"\">${views}</span></li>\n        <li class=\"card-content-item\">Downloads <span data-downloads=\"\">${downloads}</span></li>\n      </ul>\n    </li>`;\n}\n\nexport function photoCardsTemplate(photos) {\n  return photos.map(photo => photoCardTemplate(photo)).join('');\n}\n","//================================================================\n// imports\nimport axios from 'axios';\n\n// axios instance\nconst api = axios.create({\n  baseURL: 'https://pixabay.com',\n});\n\n// variables\nconst END_POINT = '/api/';\n\n// functions\nexport async function getPhotos(query, page) {\n  // форматую ввід користувача\n  query = query.toLowerCase().split(' ').join('+').toString();\n\n  // params\n  const params = {\n    key: '44424725-c6298a470a26677f9f5105ec2',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    page: page,\n    per_page: 15,\n  };\n\n  const result = await api.get(END_POINT, { params });\n  return result.data;\n}\n","//================================================================\n// imports\nimport { photoCardsTemplate } from './js/render-functions';\nimport { getPhotos } from './js/pixabay-api';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// params\nconst refs = {\n  form: document.querySelector('.entry-form'),\n  input: document.querySelector('.entry-form-input'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  loadMore: document.querySelector('.next-page'),\n};\n\nconst iziParams = {\n  titleColor: '#FFFFFF',\n  messageColor: '#FFFFFF',\n  backgroundColor: '#EF4040',\n  progressBarColor: '#B51B1B',\n  message:\n    'Sorry, there are no images matching<br>' +\n    'your search query.Please try again!',\n  position: 'topRight',\n};\n\nconst simpleParams = {\n  captions: true,\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n};\n\nconst perPage = 15;\nlet gallery;\nlet currentPage = 1;\nlet maxPage = 10;\nlet query = '';\n\n// functions\nfunction showLoader() {\n  refs.loader.classList.remove('visually-hidden');\n}\n\nfunction hideLoader() {\n  refs.loader.classList.add('visually-hidden');\n}\n\nfunction showLoadMore() {\n  refs.loadMore.classList.remove('visually-hidden');\n}\n\nfunction hideLoadMore() {\n  refs.loadMore.classList.add('visually-hidden');\n}\n\nfunction smoothScroll() {\n  const liElemHeight = refs.gallery.children[0].getBoundingClientRect().height;\n  const gap = 24;\n  window.scrollBy({\n    top: 2 * liElemHeight + gap,\n    behavior: 'smooth',\n  });\n}\n\nfunction updateBtnStatus() {\n  if (currentPage >= maxPage) {\n    hideLoadMore();\n\n    if (maxPage) {\n      iziToast.info({\n        position: 'topRight',\n        messageColor: '#FFFFFF',\n        message:\n          \"We're sorry, but you've reached<br> the end of search results.\",\n      });\n    }\n  } else {\n    showLoadMore();\n  }\n}\n\nasync function onPhotosSearch(query) {\n  showLoader();\n  hideLoadMore();\n  currentPage = 1;\n  refs.gallery.innerHTML = '';\n\n  try {\n    const data = await getPhotos(query, currentPage);\n\n    if (data.hits.length === 0) {\n      iziToast.error(iziParams);\n      return;\n    }\n    //перевірка на порожню відповідь\n\n    maxPage = Math.ceil(data.totalHits / perPage);\n    const markup = photoCardsTemplate(data.hits);\n    refs.gallery.innerHTML = markup;\n    updateBtnStatus();\n\n    gallery = new SimpleLightbox('.gallery a', simpleParams);\n    gallery.refresh();\n    gallery.on('show.simplelightbox');\n  } catch (error) {\n    iziToast.error({ ...iziParams, message: error.toString() });\n  } finally {\n    hideLoader();\n  }\n}\n\n//event listeners\nrefs.form.addEventListener('submit', e => {\n  e.preventDefault();\n  query = refs.input.value.trim();\n  onPhotosSearch(query);\n  refs.form.reset();\n});\n\nrefs.loadMore.addEventListener('click', async () => {\n  currentPage++;\n  hideLoadMore();\n  showLoader();\n\n  try {\n    const data = await getPhotos(query, currentPage);\n    const markup = photoCardsTemplate(data.hits);\n    refs.gallery.insertAdjacentHTML('beforeend', markup);\n    updateBtnStatus();\n    smoothScroll();\n\n    gallery.refresh();\n    gallery.on('show.simplelightbox');\n  } catch (error) {\n    iziToast.error({ ...iziParams, message: error.toString() });\n  } finally {\n    hideLoader();\n  }\n});\n"],"names":["photoCardTemplate","views","downloads","likes","comments","webformatURL","largeImageURL","tags","photoCardsTemplate","photos","photo","api","axios","END_POINT","getPhotos","query","page","params","refs","iziParams","simpleParams","perPage","gallery","currentPage","maxPage","showLoader","hideLoader","showLoadMore","hideLoadMore","smoothScroll","liElemHeight","gap","updateBtnStatus","iziToast","onPhotosSearch","data","markup","SimpleLightbox","error","e"],"mappings":"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"}